(my_new_env) [dqin34@atl1-1-03-004-23-0 scratch]$ python phi_prune_sci_eval_vqa_doc.py
Loading ScienceQA dataset...
Filtering valid examples...
Total valid examples: 2017
Shuffling and splitting dataset...
Loading VQA v2 dataset...
Loading DocVQA dataset...
Shuffling and splitting dataset...
/home/hice1/dqin34/.local/lib/python3.10/site-packages/transformers/models/auto/image_processing_auto.py:520: FutureWarning: The image_processor_class argument is deprecated and will be removed in v4.42. Please use `slow_image_processor_class`, or `fast_image_processor_class` instead
  warnings.warn(
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.12s/it]

Starting fine-tuning...
  0%|                                                                                                                                                                                                                                                                                        | 0/2880 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
{'loss': 4.8173, 'grad_norm': 245.0, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.01}                                                                                                                                                                                                                           
{'loss': 2.4782, 'grad_norm': 124.0, 'learning_rate': 1.6000000000000003e-05, 'epoch': 0.02}                                                                                                                                                                                                                          
{'loss': 1.568, 'grad_norm': 99.5, 'learning_rate': 2.4e-05, 'epoch': 0.03}                                                                                                                                                                                                                                           
{'loss': 0.9831, 'grad_norm': 126.0, 'learning_rate': 3.2000000000000005e-05, 'epoch': 0.04}                                                                                                                                                                                                                          
{'loss': 4.0619, 'grad_norm': 165.0, 'learning_rate': 4e-05, 'epoch': 0.05}                                                                                                                                                                                                                                           
{'loss': 2.7858, 'grad_norm': 33.5, 'learning_rate': 3.985865724381626e-05, 'epoch': 0.06}                                                                                                                                                                                                                            
{'loss': 2.6788, 'grad_norm': 50.0, 'learning_rate': 3.971731448763251e-05, 'epoch': 0.07}                                                                                                                                                                                                                            
{'loss': 1.513, 'grad_norm': 32.5, 'learning_rate': 3.9575971731448765e-05, 'epoch': 0.08}                                                                                                                                                                                                                            
{'loss': 1.3778, 'grad_norm': 52.75, 'learning_rate': 3.943462897526502e-05, 'epoch': 0.09}                                                                                                                                                                                                                           
{'loss': 1.0552, 'grad_norm': 35.25, 'learning_rate': 3.929328621908128e-05, 'epoch': 0.1}                                                                                                                                                                                                                            
{'loss': 1.2497, 'grad_norm': 13.4375, 'learning_rate': 3.915194346289753e-05, 'epoch': 0.11}                                                                                                                                                                                                                         
{'loss': 2.3571, 'grad_norm': 69.0, 'learning_rate': 3.901060070671378e-05, 'epoch': 0.12}                                                                                                                                                                                                                            
{'loss': 1.7951, 'grad_norm': 33.25, 'learning_rate': 3.886925795053004e-05, 'epoch': 0.14}                                                                                                                                                                                                                           
{'loss': 1.1296, 'grad_norm': 35.75, 'learning_rate': 3.8727915194346296e-05, 'epoch': 0.15}                                                                                                                                                                                                                          
{'loss': 1.3133, 'grad_norm': 32.0, 'learning_rate': 3.8586572438162545e-05, 'epoch': 0.16}                                                                                                                                                                                                                           
{'loss': 1.2731, 'grad_norm': 26.75, 'learning_rate': 3.84452296819788e-05, 'epoch': 0.17}                                                                                                                                                                                                                            
{'loss': 1.3106, 'grad_norm': 145.0, 'learning_rate': 3.830388692579506e-05, 'epoch': 0.18}                                                                                                                                                                                                                           
{'loss': 1.092, 'grad_norm': 72.0, 'learning_rate': 3.8162544169611314e-05, 'epoch': 0.19}                                                                                                                                                                                                                            
{'loss': 1.5343, 'grad_norm': 39.0, 'learning_rate': 3.802120141342756e-05, 'epoch': 0.2}                                                                                                                                                                                                                             
{'loss': 1.4289, 'grad_norm': 26.25, 'learning_rate': 3.787985865724382e-05, 'epoch': 0.21}                                                                                                                                                                                                                           
{'loss': 1.7533, 'grad_norm': 47.75, 'learning_rate': 3.7738515901060075e-05, 'epoch': 0.22}                                                                                                                                                                                                                          
{'loss': 1.1159, 'grad_norm': 39.75, 'learning_rate': 3.759717314487633e-05, 'epoch': 0.23}                                                                                                                                                                                                                           
{'loss': 1.4994, 'grad_norm': 68.5, 'learning_rate': 3.745583038869258e-05, 'epoch': 0.24}                                                                                                                                                                                                                            
{'loss': 1.2157, 'grad_norm': 48.0, 'learning_rate': 3.731448763250884e-05, 'epoch': 0.25}                                                                                                                                                                                                                            
{'loss': 1.3456, 'grad_norm': 101.0, 'learning_rate': 3.7173144876325093e-05, 'epoch': 0.26}                                                                                                                                                                                                                          
{'loss': 1.4246, 'grad_norm': 33.25, 'learning_rate': 3.703180212014135e-05, 'epoch': 0.27}                                                                                                                                                                                                                           
{'loss': 2.0715, 'grad_norm': 43.75, 'learning_rate': 3.68904593639576e-05, 'epoch': 0.28}                                                                                                                                                                                                                            
{'loss': 1.2327, 'grad_norm': 43.25, 'learning_rate': 3.6749116607773855e-05, 'epoch': 0.29}                                                                                                                                                                                                                          
{'loss': 1.416, 'grad_norm': 157.0, 'learning_rate': 3.6607773851590105e-05, 'epoch': 0.3}                                                                                                                                                                                                                            
{'loss': 1.2494, 'grad_norm': 29.25, 'learning_rate': 3.646643109540637e-05, 'epoch': 0.31}                                                                                                                                                                                                                           
{'loss': 1.3298, 'grad_norm': 53.5, 'learning_rate': 3.632508833922262e-05, 'epoch': 0.32}                                                                                                                                                                                                                            
{'loss': 1.3974, 'grad_norm': 58.5, 'learning_rate': 3.618374558303887e-05, 'epoch': 0.33}                                                                                                                                                                                                                            
{'loss': 1.0596, 'grad_norm': 12.0, 'learning_rate': 3.604240282685512e-05, 'epoch': 0.34}                                                                                                                                                                                                                            
{'loss': 2.1021, 'grad_norm': 11.5625, 'learning_rate': 3.5901060070671386e-05, 'epoch': 0.35}                                                                                                                                                                                                                        
{'loss': 2.3602, 'grad_norm': 29.125, 'learning_rate': 3.5759717314487635e-05, 'epoch': 0.36}                                                                                                                                                                                                                         
{'loss': 1.4524, 'grad_norm': 27.75, 'learning_rate': 3.561837455830389e-05, 'epoch': 0.38}                                                                                                                                                                                                                           
{'loss': 1.388, 'grad_norm': 24.875, 'learning_rate': 3.547703180212014e-05, 'epoch': 0.39}                                                                                                                                                                                                                           
{'loss': 1.3064, 'grad_norm': 22.625, 'learning_rate': 3.53356890459364e-05, 'epoch': 0.4}                                                                                                                                                                                                                            
{'loss': 1.4986, 'grad_norm': 35.75, 'learning_rate': 3.519434628975265e-05, 'epoch': 0.41}                                                                                                                                                                                                                           
{'loss': 1.5024, 'grad_norm': 16.0, 'learning_rate': 3.505300353356891e-05, 'epoch': 0.42}                                                                                                                                                                                                                            
{'loss': 1.2999, 'grad_norm': 34.25, 'learning_rate': 3.491166077738516e-05, 'epoch': 0.43}                                                                                                                                                                                                                           
{'loss': 1.6326, 'grad_norm': 32.75, 'learning_rate': 3.4770318021201415e-05, 'epoch': 0.44}                                                                                                                                                                                                                          
{'loss': 1.6347, 'grad_norm': 25.625, 'learning_rate': 3.462897526501767e-05, 'epoch': 0.45}                                                                                                                                                                                                                          
{'loss': 1.2895, 'grad_norm': 28.875, 'learning_rate': 3.448763250883393e-05, 'epoch': 0.46}                                                                                                                                                                                                                          
{'loss': 1.4354, 'grad_norm': 29.875, 'learning_rate': 3.434628975265018e-05, 'epoch': 0.47}                                                                                                                                                                                                                          
{'loss': 1.3959, 'grad_norm': 29.5, 'learning_rate': 3.420494699646643e-05, 'epoch': 0.48}                                                                                                                                                                                                                            
{'loss': 1.5011, 'grad_norm': 31.875, 'learning_rate': 3.406360424028269e-05, 'epoch': 0.49}                                                                                                                                                                                                                          
{'loss': 1.1719, 'grad_norm': 27.875, 'learning_rate': 3.3922261484098945e-05, 'epoch': 0.5}                                                                                                                                                                                                                          
{'loss': 1.3497, 'grad_norm': 33.25, 'learning_rate': 3.3780918727915195e-05, 'epoch': 0.51}                                                                                                                                                                                                                          
{'loss': 1.1819, 'grad_norm': 23.625, 'learning_rate': 3.363957597173145e-05, 'epoch': 0.52}                                                                                                                                                                                                                          
{'loss': 1.2953, 'grad_norm': 29.75, 'learning_rate': 3.349823321554771e-05, 'epoch': 0.53}                                                                                                                                                                                                                           
{'loss': 1.476, 'grad_norm': 16.75, 'learning_rate': 3.3356890459363963e-05, 'epoch': 0.54}                                                                                                                                                                                                                           
{'loss': 1.1498, 'grad_norm': 28.875, 'learning_rate': 3.321554770318021e-05, 'epoch': 0.55}                                                                                                                                                                                                                          
{'loss': 1.1995, 'grad_norm': 25.125, 'learning_rate': 3.307420494699647e-05, 'epoch': 0.56}                                                                                                                                                                                                                          
{'loss': 1.4906, 'grad_norm': 42.0, 'learning_rate': 3.2932862190812725e-05, 'epoch': 0.57}                                                                                                                                                                                                                           
{'loss': 1.8232, 'grad_norm': 23.875, 'learning_rate': 3.279151943462898e-05, 'epoch': 0.58}                                                                                                                                                                                                                          
{'loss': 1.3265, 'grad_norm': 24.375, 'learning_rate': 3.265017667844523e-05, 'epoch': 0.59}                                                                                                                                                                                                                          
{'loss': 1.3347, 'grad_norm': 40.5, 'learning_rate': 3.250883392226149e-05, 'epoch': 0.6}                                                                                                                                                                                                                             
{'loss': 1.2925, 'grad_norm': 29.5, 'learning_rate': 3.236749116607774e-05, 'epoch': 0.61}                                                                                                                                                                                                                            
{'loss': 1.3944, 'grad_norm': 27.375, 'learning_rate': 3.222614840989399e-05, 'epoch': 0.62}                                                                                                                                                                                                                          
{'loss': 1.3331, 'grad_norm': 108.5, 'learning_rate': 3.208480565371025e-05, 'epoch': 0.64}                                                                                                                                                                                                                           
{'loss': 1.3615, 'grad_norm': 29.875, 'learning_rate': 3.1943462897526505e-05, 'epoch': 0.65}                                                                                                                                                                                                                         
{'loss': 1.2019, 'grad_norm': 40.75, 'learning_rate': 3.180212014134276e-05, 'epoch': 0.66}                                                                                                                                                                                                                           
{'loss': 1.2989, 'grad_norm': 25.75, 'learning_rate': 3.166077738515901e-05, 'epoch': 0.67}                                                                                                                                                                                                                           
{'loss': 1.3763, 'grad_norm': 50.75, 'learning_rate': 3.151943462897527e-05, 'epoch': 0.68}                                                                                                                                                                                                                           
{'loss': 1.2841, 'grad_norm': 103.5, 'learning_rate': 3.137809187279152e-05, 'epoch': 0.69}                                                                                                                                                                                                                           
{'loss': 1.2369, 'grad_norm': 46.75, 'learning_rate': 3.123674911660778e-05, 'epoch': 0.7}                                                                                                                                                                                                                            
{'loss': 1.2313, 'grad_norm': 34.75, 'learning_rate': 3.109540636042403e-05, 'epoch': 0.71}                                                                                                                                                                                                                           
{'loss': 1.2009, 'grad_norm': 27.625, 'learning_rate': 3.0954063604240285e-05, 'epoch': 0.72}                                                                                                                                                                                                                         
{'loss': 0.8946, 'grad_norm': 25.875, 'learning_rate': 3.081272084805654e-05, 'epoch': 0.73}                                                                                                                                                                                                                          
{'loss': 1.3238, 'grad_norm': 67.0, 'learning_rate': 3.06713780918728e-05, 'epoch': 0.74}                                                                                                                                                                                                                             
{'loss': 1.088, 'grad_norm': 19.75, 'learning_rate': 3.053003533568905e-05, 'epoch': 0.75}                                                                                                                                                                                                                            
{'loss': 1.5914, 'grad_norm': 53.25, 'learning_rate': 3.03886925795053e-05, 'epoch': 0.76}                                                                                                                                                                                                                            
{'loss': 1.3794, 'grad_norm': 80.5, 'learning_rate': 3.024734982332156e-05, 'epoch': 0.77}                                                                                                                                                                                                                            
{'loss': 1.391, 'grad_norm': 74.0, 'learning_rate': 3.0106007067137812e-05, 'epoch': 0.78}                                                                                                                                                                                                                            
{'loss': 1.0773, 'grad_norm': 21.5, 'learning_rate': 2.9964664310954065e-05, 'epoch': 0.79}                                                                                                                                                                                                                           
{'loss': 1.2633, 'grad_norm': 58.5, 'learning_rate': 2.9823321554770318e-05, 'epoch': 0.8}                                                                                                                                                                                                                            
{'loss': 1.5158, 'grad_norm': 43.0, 'learning_rate': 2.9681978798586577e-05, 'epoch': 0.81}                                                                                                                                                                                                                           
{'loss': 0.881, 'grad_norm': 27.0, 'learning_rate': 2.954063604240283e-05, 'epoch': 0.82}                                                                                                                                                                                                                             
{'loss': 1.0928, 'grad_norm': 24.0, 'learning_rate': 2.9399293286219083e-05, 'epoch': 0.83}                                                                                                                                                                                                                           
{'loss': 0.8224, 'grad_norm': 25.5, 'learning_rate': 2.9257950530035336e-05, 'epoch': 0.84}                                                                                                                                                                                                                           
{'loss': 1.5609, 'grad_norm': 62.0, 'learning_rate': 2.9116607773851592e-05, 'epoch': 0.85}                                                                                                                                                                                                                           
{'loss': 2.2365, 'grad_norm': 42.75, 'learning_rate': 2.8975265017667848e-05, 'epoch': 0.86}                                                                                                                                                                                                                          
{'loss': 1.9433, 'grad_norm': 89.5, 'learning_rate': 2.88339222614841e-05, 'epoch': 0.88}                                                                                                                                                                                                                             
 29%|████████████████████████████████████████████                                                                                                          | 845/2880 [08:05<19:32,  1.74it/s]{'loss': 1.2898, 'grad_norm': 67.0, 'learning_rate': 2.8692579505300354e-05, 'epoch': 0.89}                                                                                                   
{'loss': 1.1518, 'grad_norm': 56.5, 'learning_rate': 2.855123674911661e-05, 'epoch': 0.9}                                                                                                     
{'loss': 1.4774, 'grad_norm': 44.0, 'learning_rate': 2.8409893992932866e-05, 'epoch': 0.91}                                                                                                   
{'loss': 1.0022, 'grad_norm': 23.0, 'learning_rate': 2.826855123674912e-05, 'epoch': 0.92}                                                                                                    
{'loss': 2.0377, 'grad_norm': 63.75, 'learning_rate': 2.8127208480565372e-05, 'epoch': 0.93}                                                                                                  
{'loss': 0.975, 'grad_norm': 51.5, 'learning_rate': 2.7985865724381628e-05, 'epoch': 0.94}                                                                                                    
{'loss': 1.5048, 'grad_norm': 50.75, 'learning_rate': 2.784452296819788e-05, 'epoch': 0.95}                                                                                                   
{'loss': 1.2061, 'grad_norm': 33.25, 'learning_rate': 2.7703180212014137e-05, 'epoch': 0.96}                                                                                                  
{'loss': 1.3962, 'grad_norm': 25.375, 'learning_rate': 2.756183745583039e-05, 'epoch': 0.97}                                                                                                  
{'loss': 1.2508, 'grad_norm': 25.375, 'learning_rate': 2.7420494699646646e-05, 'epoch': 0.98}                                                                                                 
{'loss': 1.0207, 'grad_norm': 25.0, 'learning_rate': 2.72791519434629e-05, 'epoch': 0.99}                                                                                                     
{'loss': 1.478, 'grad_norm': 38.75, 'learning_rate': 2.7137809187279155e-05, 'epoch': 1.0}                                                                                                    
{'loss': 1.3552, 'grad_norm': 56.25, 'learning_rate': 2.6996466431095408e-05, 'epoch': 1.01}                                                                                                  
{'loss': 1.6552, 'grad_norm': 40.75, 'learning_rate': 2.6855123674911664e-05, 'epoch': 1.02}                                                                                                  
{'loss': 1.0558, 'grad_norm': 24.0, 'learning_rate': 2.6713780918727917e-05, 'epoch': 1.03}                                                                                                   
{'loss': 1.5156, 'grad_norm': 34.75, 'learning_rate': 2.657243816254417e-05, 'epoch': 1.04}                                                                                                   
{'loss': 1.396, 'grad_norm': 56.75, 'learning_rate': 2.6431095406360426e-05, 'epoch': 1.05}                                                                                                   
{'loss': 1.1231, 'grad_norm': 38.0, 'learning_rate': 2.6289752650176682e-05, 'epoch': 1.06}                                                                                                   
{'loss': 1.4318, 'grad_norm': 119.0, 'learning_rate': 2.6148409893992935e-05, 'epoch': 1.07}                                                                                                  
{'loss': 1.011, 'grad_norm': 55.25, 'learning_rate': 2.6007067137809188e-05, 'epoch': 1.08}                                                                                                   
{'loss': 1.1506, 'grad_norm': 73.0, 'learning_rate': 2.5865724381625447e-05, 'epoch': 1.09}                                                                                                   
{'loss': 1.7476, 'grad_norm': 262.0, 'learning_rate': 2.57243816254417e-05, 'epoch': 1.1}                                                                                                     
{'loss': 1.6056, 'grad_norm': 91.0, 'learning_rate': 2.5583038869257953e-05, 'epoch': 1.11}                                                                                                   
{'loss': 1.9787, 'grad_norm': 49.0, 'learning_rate': 2.5441696113074206e-05, 'epoch': 1.12}                                                                                                   
{'loss': 1.1695, 'grad_norm': 96.5, 'learning_rate': 2.5300353356890465e-05, 'epoch': 1.14}                                                                                                   
{'loss': 1.1191, 'grad_norm': 24.0, 'learning_rate': 2.5159010600706718e-05, 'epoch': 1.15}                                                                                                   
{'loss': 1.4899, 'grad_norm': 113.5, 'learning_rate': 2.501766784452297e-05, 'epoch': 1.16}                                                                                                   
{'loss': 1.0052, 'grad_norm': 28.625, 'learning_rate': 2.4876325088339224e-05, 'epoch': 1.17}                                                                                                 
{'loss': 0.8205, 'grad_norm': 38.25, 'learning_rate': 2.4734982332155476e-05, 'epoch': 1.18}                                                                                                  
{'loss': 1.1744, 'grad_norm': 229.0, 'learning_rate': 2.4593639575971736e-05, 'epoch': 1.19}                                                                                                  
{'loss': 1.3641, 'grad_norm': 22.5, 'learning_rate': 2.445229681978799e-05, 'epoch': 1.2}                                                                                                     
{'loss': 2.1198, 'grad_norm': 80.5, 'learning_rate': 2.4310954063604242e-05, 'epoch': 1.21}                                                                                                   
{'loss': 1.0456, 'grad_norm': 34.25, 'learning_rate': 2.4169611307420495e-05, 'epoch': 1.22}                                                                                                  
{'loss': 1.19, 'grad_norm': 32.75, 'learning_rate': 2.4028268551236754e-05, 'epoch': 1.23}                                                                                                    
{'loss': 1.3366, 'grad_norm': 31.0, 'learning_rate': 2.3886925795053007e-05, 'epoch': 1.24}                                                                                                   
{'loss': 1.1726, 'grad_norm': 155.0, 'learning_rate': 2.374558303886926e-05, 'epoch': 1.25}                                                                                                   
{'loss': 0.9613, 'grad_norm': 28.625, 'learning_rate': 2.3604240282685513e-05, 'epoch': 1.26}                                                                                                 
{'loss': 1.3499, 'grad_norm': 61.0, 'learning_rate': 2.3462897526501765e-05, 'epoch': 1.27}                                                                                                   
{'loss': 1.4665, 'grad_norm': 97.0, 'learning_rate': 2.3321554770318025e-05, 'epoch': 1.28}                                                                                                   
{'loss': 1.0541, 'grad_norm': 81.5, 'learning_rate': 2.3180212014134278e-05, 'epoch': 1.29}                                                                                                   
{'loss': 1.9176, 'grad_norm': 32.75, 'learning_rate': 2.303886925795053e-05, 'epoch': 1.3}                                                                                                    
{'loss': 1.6659, 'grad_norm': 42.25, 'learning_rate': 2.2897526501766783e-05, 'epoch': 1.31}                                                                                                  
{'loss': 1.3243, 'grad_norm': 34.25, 'learning_rate': 2.2756183745583043e-05, 'epoch': 1.32}                                                                                                  
{'loss': 1.2588, 'grad_norm': 16.375, 'learning_rate': 2.2614840989399296e-05, 'epoch': 1.33}                                                                                                 
{'loss': 1.0542, 'grad_norm': 35.0, 'learning_rate': 2.247349823321555e-05, 'epoch': 1.34}                                                                                                    
{'loss': 1.3035, 'grad_norm': 20.75, 'learning_rate': 2.23321554770318e-05, 'epoch': 1.35}                                                                                                    
{'loss': 1.1451, 'grad_norm': 166.0, 'learning_rate': 2.2190812720848058e-05, 'epoch': 1.36}                                                                                                  
{'loss': 1.3391, 'grad_norm': 33.5, 'learning_rate': 2.2049469964664314e-05, 'epoch': 1.38}                                                                                                   
{'loss': 1.2902, 'grad_norm': 28.625, 'learning_rate': 2.1908127208480567e-05, 'epoch': 1.39}                                                                                                 
{'loss': 0.7268, 'grad_norm': 29.375, 'learning_rate': 2.176678445229682e-05, 'epoch': 1.4}                                                                                                   
{'loss': 1.3137, 'grad_norm': 32.75, 'learning_rate': 2.1625441696113076e-05, 'epoch': 1.41}                                                                                                  
{'loss': 1.5294, 'grad_norm': 30.5, 'learning_rate': 2.1484098939929332e-05, 'epoch': 1.42}                                                                                                   
{'loss': 1.6973, 'grad_norm': 190.0, 'learning_rate': 2.1342756183745585e-05, 'epoch': 1.43}                                                                                                  
{'loss': 1.2344, 'grad_norm': 294.0, 'learning_rate': 2.1201413427561837e-05, 'epoch': 1.44}                                                                                                  
{'loss': 1.7731, 'grad_norm': 25.125, 'learning_rate': 2.1060070671378094e-05, 'epoch': 1.45}                                                                                                 
{'loss': 1.7923, 'grad_norm': 32.25, 'learning_rate': 2.091872791519435e-05, 'epoch': 1.46}                                                                                                   
{'loss': 1.4544, 'grad_norm': 30.25, 'learning_rate': 2.0777385159010603e-05, 'epoch': 1.47}                                                                                                  
{'loss': 1.1617, 'grad_norm': 29.25, 'learning_rate': 2.0636042402826856e-05, 'epoch': 1.48}                                                                                                  
{'loss': 1.384, 'grad_norm': 109.0, 'learning_rate': 2.0494699646643112e-05, 'epoch': 1.49}                                                                                                   
{'loss': 1.6584, 'grad_norm': 85.5, 'learning_rate': 2.0353356890459365e-05, 'epoch': 1.5}                                                                                                    
{'loss': 1.6501, 'grad_norm': 266.0, 'learning_rate': 2.021201413427562e-05, 'epoch': 1.51}                                                                                                   
{'loss': 1.3724, 'grad_norm': 105.5, 'learning_rate': 2.0070671378091874e-05, 'epoch': 1.52}                                                                                                  
{'loss': 1.1033, 'grad_norm': 28.875, 'learning_rate': 1.992932862190813e-05, 'epoch': 1.53}                                                                                                  
{'loss': 1.2147, 'grad_norm': 61.0, 'learning_rate': 1.9787985865724383e-05, 'epoch': 1.54}                                                                                                   
{'loss': 1.5834, 'grad_norm': 26.25, 'learning_rate': 1.964664310954064e-05, 'epoch': 1.55}                                                                                                   
{'loss': 0.7302, 'grad_norm': 108.5, 'learning_rate': 1.950530035335689e-05, 'epoch': 1.56}                                                                                                   
{'loss': 2.2345, 'grad_norm': 111.5, 'learning_rate': 1.9363957597173148e-05, 'epoch': 1.57}                                                                                                  
{'loss': 1.6368, 'grad_norm': 29.125, 'learning_rate': 1.92226148409894e-05, 'epoch': 1.58}                                                                                                   
{'loss': 1.6009, 'grad_norm': 167.0, 'learning_rate': 1.9081272084805657e-05, 'epoch': 1.59}                                                                                                  
{'loss': 1.0977, 'grad_norm': 268.0, 'learning_rate': 1.893992932862191e-05, 'epoch': 1.6}                                                                                                    
{'loss': 0.92, 'grad_norm': 249.0, 'learning_rate': 1.8798586572438166e-05, 'epoch': 1.61}                                                                                                    
{'loss': 1.2315, 'grad_norm': 27.0, 'learning_rate': 1.865724381625442e-05, 'epoch': 1.62}                                                                                                    
{'loss': 1.6946, 'grad_norm': 97.5, 'learning_rate': 1.8515901060070675e-05, 'epoch': 1.64}                                                                                                   
{'loss': 1.8319, 'grad_norm': 124.5, 'learning_rate': 1.8374558303886928e-05, 'epoch': 1.65}                                                                                                  
{'loss': 1.2602, 'grad_norm': 90.5, 'learning_rate': 1.8233215547703184e-05, 'epoch': 1.66}                                                                                                   
{'loss': 1.4616, 'grad_norm': 82.5, 'learning_rate': 1.8091872791519437e-05, 'epoch': 1.67}                                                                                                   
{'loss': 1.1522, 'grad_norm': 151.0, 'learning_rate': 1.7950530035335693e-05, 'epoch': 1.68}                                                                                                  
{'loss': 1.698, 'grad_norm': 23.75, 'learning_rate': 1.7809187279151946e-05, 'epoch': 1.69}                                                                                                   
{'loss': 1.4767, 'grad_norm': 172.0, 'learning_rate': 1.76678445229682e-05, 'epoch': 1.7}                                                                                                     
{'loss': 1.5142, 'grad_norm': 104.5, 'learning_rate': 1.7526501766784455e-05, 'epoch': 1.71}                                                                                                  
{'loss': 1.3313, 'grad_norm': 25.375, 'learning_rate': 1.7385159010600707e-05, 'epoch': 1.72}                                                                                                 
{'loss': 0.8385, 'grad_norm': 49.0, 'learning_rate': 1.7243816254416964e-05, 'epoch': 1.73}                                                                                                   
{'loss': 1.0611, 'grad_norm': 63.75, 'learning_rate': 1.7102473498233216e-05, 'epoch': 1.74}                                                                                                  
{'loss': 1.1184, 'grad_norm': 35.75, 'learning_rate': 1.6961130742049473e-05, 'epoch': 1.75}                                                                                                  
{'loss': 1.792, 'grad_norm': 156.0, 'learning_rate': 1.6819787985865726e-05, 'epoch': 1.76}                                                                                                   
{'loss': 1.3499, 'grad_norm': 49.25, 'learning_rate': 1.6678445229681982e-05, 'epoch': 1.77}                                                                                                  
{'loss': 1.255, 'grad_norm': 39.0, 'learning_rate': 1.6537102473498235e-05, 'epoch': 1.78}                                                                                                    
{'loss': 1.1933, 'grad_norm': 243.0, 'learning_rate': 1.639575971731449e-05, 'epoch': 1.79}                                                                                                   
{'loss': 1.5098, 'grad_norm': 35.25, 'learning_rate': 1.6254416961130744e-05, 'epoch': 1.8}                                                                                                   
{'loss': 1.1815, 'grad_norm': 42.75, 'learning_rate': 1.6113074204946996e-05, 'epoch': 1.81}                                                                                                  
{'loss': 1.2482, 'grad_norm': 296.0, 'learning_rate': 1.5971731448763253e-05, 'epoch': 1.82}                                                                                                  
{'loss': 1.6999, 'grad_norm': 105.5, 'learning_rate': 1.5830388692579505e-05, 'epoch': 1.83}                                                                                                  
{'loss': 1.7586, 'grad_norm': 67.5, 'learning_rate': 1.568904593639576e-05, 'epoch': 1.84}                                                                                                    
{'loss': 1.1992, 'grad_norm': 104.0, 'learning_rate': 1.5547703180212014e-05, 'epoch': 1.85}                                                                                                  
{'loss': 1.6325, 'grad_norm': 708.0, 'learning_rate': 1.540636042402827e-05, 'epoch': 1.86}                                                                                                   
{'loss': 1.6967, 'grad_norm': 3696.0, 'learning_rate': 1.5265017667844523e-05, 'epoch': 1.88}                                                                                                 
{'loss': 1.31, 'grad_norm': 73.5, 'learning_rate': 1.512367491166078e-05, 'epoch': 1.89}                                                                                                      
{'loss': 1.3295, 'grad_norm': 25.25, 'learning_rate': 1.4982332155477032e-05, 'epoch': 1.9}                                                                                                   
{'loss': 2.1695, 'grad_norm': 125.5, 'learning_rate': 1.4840989399293289e-05, 'epoch': 1.91}                                                                                                  
{'loss': 2.1101, 'grad_norm': 1.90625, 'learning_rate': 1.4699646643109541e-05, 'epoch': 1.92}                                                                                                
{'loss': 1.0301, 'grad_norm': 2.765625, 'learning_rate': 1.4558303886925796e-05, 'epoch': 1.93}                                                                                               
{'loss': 2.2415, 'grad_norm': 107.0, 'learning_rate': 1.441696113074205e-05, 'epoch': 1.94}                                                                                                   
{'loss': 1.3619, 'grad_norm': 532.0, 'learning_rate': 1.4275618374558305e-05, 'epoch': 1.95}                                                                                                  
{'loss': 1.5066, 'grad_norm': 79.0, 'learning_rate': 1.413427561837456e-05, 'epoch': 1.96}                                                                                                    
{'loss': 2.5668, 'grad_norm': 410.0, 'learning_rate': 1.3992932862190814e-05, 'epoch': 1.97}                                                                                                  
{'loss': 2.5356, 'grad_norm': 29.125, 'learning_rate': 1.3851590106007068e-05, 'epoch': 1.98}                                                                                                 
{'loss': 2.1965, 'grad_norm': 66.0, 'learning_rate': 1.3710247349823323e-05, 'epoch': 1.99}                                                                                                   
{'loss': 1.5943, 'grad_norm': 474.0, 'learning_rate': 1.3568904593639577e-05, 'epoch': 2.0}                                                                                                   
{'loss': 0.9048, 'grad_norm': 1.5546875, 'learning_rate': 1.3427561837455832e-05, 'epoch': 2.01}                                                                                              
{'loss': 1.1234, 'grad_norm': 34.0, 'learning_rate': 1.3286219081272085e-05, 'epoch': 2.02}                                                                                                   
{'loss': 1.131, 'grad_norm': 26.375, 'learning_rate': 1.3144876325088341e-05, 'epoch': 2.03}                                                                                                  
{'loss': 1.0686, 'grad_norm': 28.375, 'learning_rate': 1.3003533568904594e-05, 'epoch': 2.04}                                                                                                 
{'loss': 0.9814, 'grad_norm': 98.0, 'learning_rate': 1.286219081272085e-05, 'epoch': 2.05}                                                                                                    
{'loss': 0.8657, 'grad_norm': 29.875, 'learning_rate': 1.2720848056537103e-05, 'epoch': 2.06}                                                                                                 
{'loss': 1.2868, 'grad_norm': 21.75, 'learning_rate': 1.2579505300353359e-05, 'epoch': 2.07}                                                                                                  
{'loss': 1.22, 'grad_norm': 28.0, 'learning_rate': 1.2438162544169612e-05, 'epoch': 2.08}                                                                                                     
{'loss': 0.8723, 'grad_norm': 13.3125, 'learning_rate': 1.2296819787985868e-05, 'epoch': 2.09}                                                                                                
{'loss': 1.0921, 'grad_norm': 27.0, 'learning_rate': 1.2155477031802121e-05, 'epoch': 2.1}                                                                                                    
{'loss': 1.2287, 'grad_norm': 88.0, 'learning_rate': 1.2014134275618377e-05, 'epoch': 2.11}                                                                                                   
{'loss': 0.9238, 'grad_norm': 98.5, 'learning_rate': 1.187279151943463e-05, 'epoch': 2.12}                                                                                                    
{'loss': 1.5388, 'grad_norm': 2368.0, 'learning_rate': 1.1731448763250883e-05, 'epoch': 2.14}                                                                                                 
{'loss': 1.8766, 'grad_norm': 42.0, 'learning_rate': 1.1590106007067139e-05, 'epoch': 2.15}                                                                                                   
{'loss': 2.197, 'grad_norm': 26.5, 'learning_rate': 1.1448763250883392e-05, 'epoch': 2.16}                                                                                                    
{'loss': 1.142, 'grad_norm': 79.5, 'learning_rate': 1.1307420494699648e-05, 'epoch': 2.17}                                                                                                    
{'loss': 1.9513, 'grad_norm': 28.25, 'learning_rate': 1.11660777385159e-05, 'epoch': 2.18}                                                                                                    
{'loss': 1.3544, 'grad_norm': 46.5, 'learning_rate': 1.1024734982332157e-05, 'epoch': 2.19}                                                                                                   
{'loss': 0.8729, 'grad_norm': 26.125, 'learning_rate': 1.088339222614841e-05, 'epoch': 2.2}                                                                                                   
{'loss': 1.0441, 'grad_norm': 1904.0, 'learning_rate': 1.0742049469964666e-05, 'epoch': 2.21}                                                                                                 
{'loss': 1.0818, 'grad_norm': 5.34375, 'learning_rate': 1.0600706713780919e-05, 'epoch': 2.22}                                                                                                
{'loss': 1.6777, 'grad_norm': 148.0, 'learning_rate': 1.0459363957597175e-05, 'epoch': 2.23}                                                                                                  
{'loss': 1.1477, 'grad_norm': 1272.0, 'learning_rate': 1.0318021201413428e-05, 'epoch': 2.24}                                                                                                 
{'loss': 1.1915, 'grad_norm': 28.625, 'learning_rate': 1.0176678445229682e-05, 'epoch': 2.25}                                                                                                 
{'loss': 0.9549, 'grad_norm': 25.875, 'learning_rate': 1.0035335689045937e-05, 'epoch': 2.26}                                                                                                 
{'loss': 1.1759, 'grad_norm': 31.75, 'learning_rate': 9.893992932862191e-06, 'epoch': 2.27}                                                                                                   
{'loss': 1.3946, 'grad_norm': 88.0, 'learning_rate': 9.752650176678446e-06, 'epoch': 2.28}                                                                                                    
{'loss': 0.6071, 'grad_norm': 0.220703125, 'learning_rate': 9.6113074204947e-06, 'epoch': 2.29}                                                                                               
{'loss': 1.3153, 'grad_norm': 74.5, 'learning_rate': 9.469964664310955e-06, 'epoch': 2.3}                                                                                                     
{'loss': 0.5288, 'grad_norm': 117.5, 'learning_rate': 9.32862190812721e-06, 'epoch': 2.31}                                                                                                    
{'loss': 1.5366, 'grad_norm': 116.0, 'learning_rate': 9.187279151943464e-06, 'epoch': 2.32}                                                                                                   
{'loss': 1.9407, 'grad_norm': 1012.0, 'learning_rate': 9.045936395759718e-06, 'epoch': 2.33}                                                                                                  
{'loss': 1.5696, 'grad_norm': 728.0, 'learning_rate': 8.904593639575973e-06, 'epoch': 2.34}                                                                                                   
{'loss': 0.605, 'grad_norm': 100.5, 'learning_rate': 8.763250883392227e-06, 'epoch': 2.35}                                                                                                    
{'loss': 1.4089, 'grad_norm': 28.0, 'learning_rate': 8.621908127208482e-06, 'epoch': 2.36}                                                                                                    
{'loss': 0.5616, 'grad_norm': 31.25, 'learning_rate': 8.480565371024736e-06, 'epoch': 2.38}                                                                                                   
{'loss': 0.8572, 'grad_norm': 76.0, 'learning_rate': 8.339222614840991e-06, 'epoch': 2.39}                                                                                                    
{'loss': 1.3984, 'grad_norm': 117.5, 'learning_rate': 8.197879858657245e-06, 'epoch': 2.4}                                                                                                    
{'loss': 1.7825, 'grad_norm': 11.125, 'learning_rate': 8.056537102473498e-06, 'epoch': 2.41}                                                                                                  
{'loss': 0.8825, 'grad_norm': 234.0, 'learning_rate': 7.915194346289753e-06, 'epoch': 2.42}                                                                                                   
{'loss': 2.3983, 'grad_norm': 264.0, 'learning_rate': 7.773851590106007e-06, 'epoch': 2.43}                                                                                                   
{'loss': 1.6901, 'grad_norm': 1008.0, 'learning_rate': 7.632508833922262e-06, 'epoch': 2.44}                                                                                                  
{'loss': 1.8058, 'grad_norm': 3.734375, 'learning_rate': 7.491166077738516e-06, 'epoch': 2.45}                                                                                                
{'loss': 1.1279, 'grad_norm': 368.0, 'learning_rate': 7.349823321554771e-06, 'epoch': 2.46}                                                                                                   
{'loss': 1.317, 'grad_norm': 708.0, 'learning_rate': 7.208480565371025e-06, 'epoch': 2.47}                                                                                                    
{'loss': 1.4459, 'grad_norm': 29.75, 'learning_rate': 7.06713780918728e-06, 'epoch': 2.48}                                                                                                    
{'loss': 1.2319, 'grad_norm': 28.25, 'learning_rate': 6.925795053003534e-06, 'epoch': 2.49}                                                                                                   
{'loss': 1.4779, 'grad_norm': 28.0, 'learning_rate': 6.784452296819789e-06, 'epoch': 2.5}                                                                                                     
{'loss': 1.2834, 'grad_norm': 2.34375, 'learning_rate': 6.643109540636042e-06, 'epoch': 2.51}                                                                                                 
{'loss': 1.0907, 'grad_norm': 28.0, 'learning_rate': 6.501766784452297e-06, 'epoch': 2.52}                                                                                                    
{'loss': 1.7293, 'grad_norm': 28.0, 'learning_rate': 6.360424028268551e-06, 'epoch': 2.53}                                                                                                    
{'loss': 2.2196, 'grad_norm': 26.125, 'learning_rate': 6.219081272084806e-06, 'epoch': 2.54}                                                                                                  
{'loss': 0.9403, 'grad_norm': 0.138671875, 'learning_rate': 6.0777385159010604e-06, 'epoch': 2.55}                                                                                            
{'loss': 0.5879, 'grad_norm': 27.875, 'learning_rate': 5.936395759717315e-06, 'epoch': 2.56}                                                                                                  
{'loss': 1.802, 'grad_norm': 0.138671875, 'learning_rate': 5.7950530035335694e-06, 'epoch': 2.57}                                                                                             
{'loss': 0.6005, 'grad_norm': 93.5, 'learning_rate': 5.653710247349824e-06, 'epoch': 2.58}                                                                                                    
{'loss': 0.7203, 'grad_norm': 294.0, 'learning_rate': 5.5123674911660785e-06, 'epoch': 2.59}                                                                                                  
{'loss': 1.7519, 'grad_norm': 26.125, 'learning_rate': 5.371024734982333e-06, 'epoch': 2.6}                                                                                                   
{'loss': 1.3606, 'grad_norm': 28.125, 'learning_rate': 5.2296819787985875e-06, 'epoch': 2.61}                                                                                                 
{'loss': 1.0942, 'grad_norm': 102.0, 'learning_rate': 5.088339222614841e-06, 'epoch': 2.62}                                                                                                   
{'loss': 1.0091, 'grad_norm': 28.375, 'learning_rate': 4.946996466431096e-06, 'epoch': 2.64}                                                                                                  
{'loss': 1.2812, 'grad_norm': 27.25, 'learning_rate': 4.80565371024735e-06, 'epoch': 2.65}                                                                                                    
{'loss': 2.3165, 'grad_norm': 26.125, 'learning_rate': 4.664310954063605e-06, 'epoch': 2.66}                                                                                                  
{'loss': 2.044, 'grad_norm': 336.0, 'learning_rate': 4.522968197879859e-06, 'epoch': 2.67}                                                                                                    
{'loss': 3.0864, 'grad_norm': 103.5, 'learning_rate': 4.381625441696114e-06, 'epoch': 2.68}                                                                                                   
{'loss': 1.3431, 'grad_norm': 93.0, 'learning_rate': 4.240282685512368e-06, 'epoch': 2.69}                                                                                                    
{'loss': 1.5762, 'grad_norm': 21.5, 'learning_rate': 4.098939929328623e-06, 'epoch': 2.7}                                                                                                     
{'loss': 2.1761, 'grad_norm': 1584.0, 'learning_rate': 3.957597173144876e-06, 'epoch': 2.71}                                                                                                  
{'loss': 2.406, 'grad_norm': 165.0, 'learning_rate': 3.816254416961131e-06, 'epoch': 2.72}                                                                                                    
{'loss': 1.2188, 'grad_norm': 182.0, 'learning_rate': 3.6749116607773854e-06, 'epoch': 2.73}                                                                                                  
{'loss': 1.5086, 'grad_norm': 25.125, 'learning_rate': 3.53356890459364e-06, 'epoch': 2.74}                                                                                                   
{'loss': 1.9261, 'grad_norm': 28.375, 'learning_rate': 3.3922261484098944e-06, 'epoch': 2.75}                                                                                                 
{'loss': 1.3364, 'grad_norm': 27.375, 'learning_rate': 3.2508833922261485e-06, 'epoch': 2.76}                                                                                                 
{'loss': 0.9944, 'grad_norm': 0.0478515625, 'learning_rate': 3.109540636042403e-06, 'epoch': 2.77}                                                                                            
{'loss': 1.5001, 'grad_norm': 290.0, 'learning_rate': 2.9681978798586575e-06, 'epoch': 2.78}                                                                                                  
{'loss': 1.8839, 'grad_norm': 464.0, 'learning_rate': 2.826855123674912e-06, 'epoch': 2.79}                                                                                                   
{'loss': 1.4061, 'grad_norm': 0.30859375, 'learning_rate': 2.6855123674911665e-06, 'epoch': 2.8}                                                                                              
{'loss': 1.9339, 'grad_norm': 24.125, 'learning_rate': 2.5441696113074206e-06, 'epoch': 2.81}                                                                                                 
{'loss': 1.2537, 'grad_norm': 26.125, 'learning_rate': 2.402826855123675e-06, 'epoch': 2.82}                                                                                                  
{'loss': 1.132, 'grad_norm': 25.75, 'learning_rate': 2.2614840989399296e-06, 'epoch': 2.83}                                                                                                   
{'loss': 2.007, 'grad_norm': 18.0, 'learning_rate': 2.120141342756184e-06, 'epoch': 2.84}                                                                                                     
{'loss': 1.3447, 'grad_norm': 374.0, 'learning_rate': 1.978798586572438e-06, 'epoch': 2.85}                                                                                                   
{'loss': 1.0319, 'grad_norm': 0.01275634765625, 'learning_rate': 1.8374558303886927e-06, 'epoch': 2.86}                                                                                       
{'loss': 1.5708, 'grad_norm': 28.25, 'learning_rate': 1.6961130742049472e-06, 'epoch': 2.88}                                                                                                  
{'loss': 2.9493, 'grad_norm': 179.0, 'learning_rate': 1.5547703180212015e-06, 'epoch': 2.89}                                                                                                  
{'loss': 1.2387, 'grad_norm': 604.0, 'learning_rate': 1.413427561837456e-06, 'epoch': 2.9}                                                                                                    
{'loss': 1.6825, 'grad_norm': 1.65625, 'learning_rate': 1.2720848056537103e-06, 'epoch': 2.91}                                                                                                
{'loss': 1.1975, 'grad_norm': 2000.0, 'learning_rate': 1.1307420494699648e-06, 'epoch': 2.92}                                                                                                 
{'loss': 1.0525, 'grad_norm': 680.0, 'learning_rate': 9.89399293286219e-07, 'epoch': 2.93}                                                                                                    
{'loss': 0.7527, 'grad_norm': 30.875, 'learning_rate': 8.480565371024736e-07, 'epoch': 2.94}                                                                                                  
{'loss': 1.7012, 'grad_norm': 1896.0, 'learning_rate': 7.06713780918728e-07, 'epoch': 2.95}                                                                                                   
{'loss': 1.9743, 'grad_norm': 28.375, 'learning_rate': 5.653710247349824e-07, 'epoch': 2.96}                                                                                                  
{'loss': 1.9097, 'grad_norm': 27.875, 'learning_rate': 4.240282685512368e-07, 'epoch': 2.97}                                                                                                  
{'loss': 0.7991, 'grad_norm': 83.0, 'learning_rate': 2.826855123674912e-07, 'epoch': 2.98}                                                                                                    
{'loss': 1.488, 'grad_norm': 28.5, 'learning_rate': 1.413427561837456e-07, 'epoch': 2.99}                                                                                                     
{'loss': 0.8472, 'grad_norm': 26.125, 'learning_rate': 0.0, 'epoch': 3.0}                                                                                                                     
{'train_runtime': 1653.9799, 'train_samples_per_second': 1.741, 'train_steps_per_second': 1.741, 'train_loss': 1.4326310030288167, 'epoch': 3.0}                                              
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2880/2880 [27:33<00:00,  1.74it/s]
Fine-tuning completed in 1654.13 seconds.
Evaluating model on test dataset...
  0%|                                                                                                                                                                 | 0/240 [00:00<?, ?it/s]/home/hice1/dqin34/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:590: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
`get_max_cache()` is deprecated for all Cache classes. Use `get_max_cache_shape()` instead. Calling `get_max_cache()` will raise error from v4.48
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 240/240 [02:45<00:00,  1.45it/s]
Evaluation completed in 165.09 seconds.
BERT Score F1: 0.7175779494146506
Fine-tuning time: 1654.13 seconds, Evaluation time: 165.09 seconds.